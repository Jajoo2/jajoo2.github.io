<!doctype html>
<html>

<head>
	<meta charset=utf-8>
	<meta name='viewport' content='width=device-width, height=device-height, initial-scale=1'>
	<title>Upload a thing</title>
	<link rel="stylesheet" type="text/css" href="css/style.css" />
	<script src="js/script.js"></script>
</head>

<body>
	<div style="display: flex;">
		<div class="sidebar" id="sidebar"></div>
		<div id="toast-container"></div>
		
		<div class="content">
			<div id="page1">
				<button id="ststs" onclick="document.getElementById('page1').style.display = 'none'; document.getElementById('page2').style.display = '';" style="display: flex; align-items: center; white-space: pre;">Preview  <span class="material-symbols-outlined">arrow_forward</span></button>
				<div style="display:flex; gap: 20px;">
					<div style="width: fit-content; display: flex; flex-direction: column; padding: 20px; gap: 20px; background-color: rgb(22, 14, 29);">
						<h2>Upload Thing</h2>
						<form id="form" style="display: flex; flex-direction: column; gap: 5px;">
							<input name="title" type="text" placeholder="Title" required>
							<input name="summary" type="text" placeholder="Summary" required>
							<input name="image" type="text" placeholder="Image URL">
							<textarea name="body" style="width: 500px; height: 100px;" placeholder="Body" required></textarea>
							
							<button type="submit" style="align-self:first baseline; color: #222; background-color: rgb(100, 167, 61);">Submit</button>
						</form>
					</div>
				</div>
			</div>
			
			<div id="page2" style="display: none;">
				<button onclick="document.getElementById('page2').style.display = 'none'; document.getElementById('page1').style.display = '';" style="display: flex; align-items: center; white-space: pre;"><span class="material-symbols-outlined">arrow_back</span>  Back</button>
				<div style="display: flex; gap: 20px;">
					<div class="content" style="width: 100% !important; flex-direction: column;">
						<p style="color: #cccccc55; font-size: smaller; margin: 0;" id="authorname"></p>
						<h2 id="title" style="margin: 0;">Title or something</h2>
						<hr>
						<p id="body" style="white-space: pre-wrap; margin: 0;">Body or something</p>
						<hr>
						
						<h3>thumb preview</h3>
						<div class="thingyard_grid">
							<a href="#">
								<div name="thumb">
									<img name="img" id="thumbimg">
									<div name="gradient"></div>
									<span name="title" id="thumbtitle">hello world</span>
									<span name="subtitle" id="thumbsumm">simple introductory</span>
								</div>
							</a>
						</div>
					</div>
				</div>
				
			</div>

			<script>
				var form = document.getElementById("form");
				var user = localStorage.getItem("user");
				var password = localStorage.getItem("password");

				form.addEventListener("submit", async e => {
					e.preventDefault();
					const data = {
						user: user,
						password: password,
						title: form.title.value,
						summary: form.summary.value,
						image: form.image.value,
						body: form.body.value,
					};
					const res = await fetch("https://api.meisite.xyz//thingyard/upload", {
						method: "POST",
						headers: { "Content-Type": "application/json" },
						body: JSON.stringify(data)
					});
					var response = await res.json();
					console.log(response);
					if (res.ok) {
						showToast("Success");
					} else {
						showToast("Failed!! Reason: " + response.reason, 5000);
					}
				});
			</script>
			<script>
				document.getElementById("ststs").addEventListener('click', function()
				{
					var formtmp = document.getElementById("form");
					document.getElementById("title").innerText = formtmp.title.value;
					document.getElementById("thumbtitle").innerText = formtmp.title.value;
					document.getElementById("thumbsumm").innerText = formtmp.summary.value;
					document.getElementById("thumbimg").src = formtmp.image.value;
					document.getElementById("body").innerHTML = formtmp.body.value;
					document.getElementById("authorname").innerText = localStorage.getItem("user");
				})
			</script>
		</div>
	</div>
</body>

</html>