<!doctype html>
<html>

<head>
	<meta charset=utf-8>
	<meta name='viewport' content='width=device-width, height=device-height, initial-scale=1'>
	<title>Upload a file</title>
	<link rel="stylesheet" type="text/css" href="css/style.css" />
	<script src="js/script.js"></script>
</head>

<body>
	<div style="display: flex;">
		<div class="sidebar" id="sidebar"></div>
		<div id="toast-container"></div>

		<div class="content">
			<div style="display:flex; gap: 20px;">
				<div
					style="width: fit-content; display: flex; flex-direction: column; padding: 20px; gap: 20px; background-color: rgb(22, 14, 29);">
					<h2>Upload file</h2>
					<p>NOTE: File max size is 250 MB. Sorry, storage is expensive!</p>
					<input type="file" id="fileInput">
					<button id="upload">Upload</button>
					<p id="statusP">File status here</p>
					<script>
						const user = localStorage.getItem("user");
						const password = localStorage.getItem("password");
						const input = document.getElementById("fileInput");
						const statusp = document.getElementById("statusP");
						document.getElementById("upload").addEventListener("click", function () {
							const user = localStorage.getItem("user");
							const password = localStorage.getItem("password");
							const fileInput = document.getElementById("fileInput");

							const fd = new FormData();
							fd.append("user", user);
							fd.append("password", password);

							if (fileInput.files.length === 0) {
								console.log("no file selected");
								return;
							}

							fd.append("file", fileInput.files[0]);

							fetch("https://api.meisite.xyz//uploadfile", {
								method: "POST",
								body: fd
							})
								.then(response => response.json())
								.then(data => {
									console.log("done", data);
									let resn = ""
									if(data.reason)
									{
										resn = data.reason
									}
									statusp.innerHTML = resn+"<br><a href=https://api.meisite.xyz//files/"+data.filename+">https://api.meisite.xyz//files/"+data.filename+"</a>"
								})
								.catch(err => {
									console.error("fetch error", err);
									statusp.innerText = err
								});
						});


					</script>
				</div>
			</div>
		</div>
	</div>
</body>

</html>